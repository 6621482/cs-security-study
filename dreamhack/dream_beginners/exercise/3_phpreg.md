# DreamHack - phpreg

## 문제 유형
- 정규표현식 기반 입력 필터 우회
- preg_replace 치환 로직 분석

## 문제 요약
목표 1 : PHP로 작성된 페이지의 코드를 보고 알맞은 Nickname, Password를 입력 (입력값은 정규표현식 필터 및 치환을 거친 뒤 비교됨)  
목표 2 : 플래그 획득

## 코드 분석 포인트
- step 1) preg_replace 기반 치환 로직
  - 입력값이 특정 정규식 패턴을 만족하면 문자열이 치환됨
  - 최종 비교는 치환된 결과를 기준으로 이루어짐
  - 조건문에 있는 id, pw를 그대로 입력하는 것이 아님 -> 맞는 결과가 나오도록 입력을 설계해야 함
- step 2) 명령어 필터링
  - 입력 명령어에 특정한 문자열이 포함되면 차단
  - 와일드카드를 통한 우회 입력이 필요

## 접근 과정
1. Step 1 : Nickname, Password 입력  
   1) 치환 후 결과가 목표 PW가 되도록 입력을 설계
   2) 치환 조건이 정규 표현식으로 적혀있어 해석이 필요함  
   3) 조건을 만족하는 Nickname/PW를 입력하면 Step2로 넘어감
2. Step 2 : 플래그 획득  
   1) 목표 파일 경로 안 특정 문자열에 필터가 걸려있음  
   2) 키워드를 직접 쓰지 않도록 와일드카드 같은 패턴을 사용하여 필터를 우회
  
## 어려웠던 점
- id를 찾는 과정에서, 정규표현식을 맞게 해석했지만 계속 오류가 생겼음
  - 조건문에 나온 id 내에 치환 대상 문자열이 있다는 것이 문제였음
  - 특정 문자열이 지워지고, 양옆에 있는 글자들이 합쳐져서 새로운 문자열이 만들어지도록 해야했음

## 배운 점
- preg_replace는 검증이 아니라 변형이기 떄문에 비교 로직을 오히려 우회 가능하게 만들 수 있음
- 단순한 문자열 차단 필터는 패턴 우회에 취약할 수 있음

## 쓰인 개념
- PHP : preg_match, preg_replace
- 정규표현식(필터링 및 치환)
- 인증 우회
- 문자열 기반 필터 우회

## 추가 내용
**Q.preg_replace()란 무엇인가?**   
- `$결과 = preg_replace($패턴, $바꿀 말, $원본문장);`
- PHP에서 정규표현식을 사용해 특정 문자열을 찾아서 바꾸는 함수
- 예시
  ```
  $phone = "010 - 1234 - 5678";
  $result = preg_replace("/\s+/", "", $phone);
  // 결과 : "01012345678"
  ```
