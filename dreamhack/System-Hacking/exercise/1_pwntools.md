## Dreamhack - pwntools

### 문제 유형
- 시스템 해킹 기초
- 원격 서비스 입출력 파싱
- 반복 입력 검증 우회 자동화

### 문제 요약
프로그램이 매 라운드마다 랜덤한 두 정수를 출력하고, 사용자가 입력한 inpt가 num1 + num2 와 같으면 다음 라운드로 진행함  
이 과정을 50번 모두 통과하면 ./flag 파일에서 플래그를 출력함  
chall.c는 문제에서 제공 (위의 내용을 구현한 코드)  

### 코드 분석 포인트
- 매 반복마다 num1, num2 랜덤으로 생성
- printf("%d+%d=?\n", num1, num2); 으로 출력
- scanf("%d", &inpt); 로 사용자에게 입력받음

### 접근 과정
1. 출력 형식 파악
   - 한 줄이 num1+num2=?\n 형태로 옴
2. pwntools로 숫자 두 개를 파싱
   - 형식에 맞춰 num1, num2를 올바르게 추출해야 함
3. 정답 계산 후 전송
4. 50번 반복 후 플래그 출력 받기

### 어려웠던 점
- num1, num2를 올바르게 추출하는 게 어려웠음
  - recv() 계열의 함수 중 어떤 것을 써야할 지 헷갈림
  - +와 =?\n을 제외하고 숫자만 받게 하는 방법을 찾는 것이 어려웠음
- 전송받은 결과 (반환값)이 bytes라는 것을 까먹고 int()를 하지 않았음
- 정답 전송 시 어떤 send() 계열의 함수를 사용해야 하는지, 형식에 맞게 전송하려면 데이터에 어떤 함수들을 취해주어야 하는지 고민이 되었음
- 마지막에 interactive()를 해주지 않아 플래그 획득을 제대로 하지 못함

### 배운 점 
- pwntools의 수신 데이터는 bytes 이므로 숫자를 계산하기 위해서는 int()로 변환해야 함
- C의 scanf("%d")는 바이너리 정수가 아니라, 아스키숫자 문자열을 읽음
  - 계산 결과를 str()로 변환한 뒤, .encode()해서 전송해야 정상적으로 동작함
- C의 scanf("%d")는 개행문자로 입력 종료를 인식함
  - sendline()을 사용해서 데이터를 전송해야 함
- interactive()을 사용해야 플래그를 터미널에 출력함

### 쓰인 개념
- pwntools 기본 입출력
  - remote()
  - recvuntil()
  - sendline()
  - interactive()
- bytes <-> 문자열 <-> 정수변환
  - bytes -> int : int(b"123")
  - int -> str -> bytes : str(num).encode()
- C 표준 입력 처리
  - scanf("%d")는 문자 기반 입력

 
