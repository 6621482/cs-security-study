# Out of Bounds (OOB)

## Out of bounds
### 배열의 속성
- 배열의 크기 : `sizeof(array) = sizeof(elem) * n`
  - 배열은 연속된 메모리 공간을 가짐
  - 각 요소의 주소 : `&array[k] = array + sizeof(elem) * k`

### Out of Bounds
- OOB : 배열의 요소를 참조할 때, 허용된 인덱스 범위(0 ~ 배열길이-1)를 벗어난 값을 사용하는 것
- 발생 원인 : 인덱스 값이 음수이거나 배열의 길이보다 큼
  - 프로세스는 배열의 요소를 찾을 때 정해진 식에 따라 메모리 주소를 계산함
  - 개발자가 인덱스 범위 검사 코드를 명시적으로 넣지 않으면, 프로세스는 계산된 주소가 실제 배열 내부인지 확인하지 않고 그대로 접근함 
- 취약점 
  - 사용자가 인덱스 값을 마음대로 조작할 수 있다면, 배열의 범위를 넘어서 개발자가 의도하지 않은 다른 메모리 영역의 값을 참조할 수 있음
  - 정보 유출이나 시스템 해킹의 원인이 되기도 함
#### OOB Read & Write
- OOB로 특정 변수의 값을 참조하기 위한 조건
  - 기준이 되는 배열의 주소와 읽고 싶은 변수의 주소 사이의 거리를 정확하게 알아야 함
  - 배열 인덱스를 이 오프셋만큼 조작하여 접근하면 해당 변수의 값을 참조할 수 있음
- 같은 세그먼트에 있는 경우 (쉬움)
  - 배열과 읽으려는 변수가 메모리 상의 같은 구역(ex. 스택, 힙 등 같은 세그먼트)에 있다면 둘 사이의 거리는 항상 일정함
  - 디버깅으로 오프셋을 알아내 공격할 수 있음
- 다른 세그먼트에 있는 경우 (어려움) 
  - 배열과 변수가 서로 다른 구역에 있으면 주소를 알기 힘듦 (ASLR)
  - 다른 취약점을 연계하여 두 변수의 실제 메모리 주소를 먼저 알아낸 뒤, 그 차이를 계산해야 함
