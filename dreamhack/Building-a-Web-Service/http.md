# HTTP / HTTPS

## 인코딩
- **인코딩(Encoding)** : 문자를 컴퓨터가 이해하고 저장할 수 있또록 0과 1의 집합(비트)으로 변환하는 것
- 대표적인 방식
  - 아스키(ASCII) : 7비트 데이터를 사용하는 초기 인코딩 표준
    - 알파벳과 특수 문자를 표현할 수 있음
  - 유니코드(Unicode)
    - 전 세계 모든 언어의 문자를 하나의 표준에 담기 위해 만들어짐
    - 한 문자를 최대 32비트로 표현할 수 있음

## 프로토콜
- 정의 : 통신 주체들이 정보를 원활하게 교환하기 위해 정해둔 규격화된 약속
- **요청(Request)** : 클라이언트가 서버에게 특정 행위를 요구하는 것
- **응답(Response)** : 서버가 클라이언트의 요청을 이해하고 그에 대응하는 결과를 반환하는 것
- 문법이 명확하고, 문법에 어긋나는 메세지는 오류로 처리되거나 무시됨

### Port
- 네트워크 포트(Network Port) : 서버와 클라이언트가 정보를 교환하는 추상화된 장소
- 서비스 포트(Service Port) : 네트워크 포트 중 특정 서비스(HTTP, SSH 등)가 점유하고 있는 포트
  - 예시 : HTTP가 80번 포트를 점유하고 있으면, HTTP의 서비스 포트는 80번 포트임
- 운영체제는 0번부터 65535번까지 총 65,536개의 포트를 가질 수 있음
  - 잘 알려진 포트(Well-known port), 특권 포트 (Privileged port) : 0번 ~ 1023번 포트를 의미하며, 주요 서비스들이 미리 할당받아 사용함
    - 22번: SSH (원격 접속)
    - 80번: HTTP (웹)
    - 443번: HTTPS (보안 웹)
    - 서비스를 실행하려면 관리자 권한이 필요함
    - 일반 사용자가 80번 포트를 사용하는 웹 서버를 띄우려고 하면, 운영체제는 Permission denied와 같은 에러를 띄움 
- 포트로 데이터를 교환하는 방식은 **전송 계층(Transport Layer)의 프로토콜을 따름
  - TCP (HTTP가 주로 사용함)  
  - UDP

### HTTP
- **HTTP(Hyper Text Transfer Protocol)** : 서버와 클라이언트가 데이터를 주고받기 위해 사용하는 프로토콜
- 메커니즘 : 클라이언트가 서버에 **요청(Request)**을 보내면, 서버가 이에 대해 **응답(Response)**함 
  - 웹 서버는 HTTP 서버를 HTTP 서비스 포트에 대기시킴 (일반적으로 TCP/80 또는 TCP/8080)
  - 클라이언트가 서비스 포트에 HTTP 요청을 전송하면, 이를 해석하여 적절한 응답을 반환함
#### HTTP 메세지 
```
┌────────────────────────────────┐
│ POST /login HTTP/1.1           │  ← 시작 줄  ──┐
├────────────────────────────────┤              
│ Connection: keep-alive         │           시작줄 + 헤더 = HTTP 헤드 
│ User-Agent: Mozilla/5.0 ...    │
│ Content-Length: 65             │  ← 헤더     ──┘
│ Content-Type: application/json |
├────────────────────────────────┤
│                                │  ← 빈 줄
├────────────────────────────────┤
│ {"email":"kim@example.com",    │
│  "password":"example1234"}     │  ← HTTP 바디
└────────────────────────────────┘
```
- HTTP 헤더(Headers)
  - 메세지의 속성과 정보를 담고있음
  - 시작 줄(Start line) : 메시지의 첫 줄로, 요청인지 응답인지에 따라 역할이 다름
  - 헤더 필드(Header) : 필드와 값(예: Host: dreamhack.io)으로 구성되며, 메시지나 바디의 속성을 나타냄
- HTTP 바디(Body)
  - 헤더가 끝나는 빈 줄(CRLF) 뒤에 오는 모든 내용
  - 클라이언트나 서버에게 실제로 전송하려는 데이터가 담기는 공간
- CRLF
  - CR(Carriage Return) + LF(Line Feed)
  - CR : 커서를 현재 줄의 맨 앞으로 이동시키는 문자
  - LF : 커서를 다음 줄로 이동시키는 문자 
  - 텍스트 파일에서 줄 바꿈을 나타내는 데 사용되는 제어 문자열 

#### HTTP 요청 
- HTTP 요청 : 클라이언트가 서버에게 특정한 동작을 수행해달라고 요구하는 메세지  
- 서버는 해당 동작이 실현 가능한지, 요청자에게 권한이 있는지 등을 검토한 후 적절할 때 이를 처리함  
- **시작 줄**
  - 구성 : 메소드 + 요청 대상 + HTTP 버전
    - 메소드(Method) : 서버가 수행하길 바라는 동작
      - GET : 리소스 획득 (서버로부터 정보를 가져와 화면을 렌더링할 때 사용함)
      - POST : 데이터 전송 (서버로 데이터를 보낼 때 사용하며, 데이터는 주로 바디에 포함됨) 
    - 요청 대상(Request target) : 메소드를 적용할 대상(주로 URI)
    - HTTP 버전 : 클라이언트가 사용하는 HTTP 프로토콜의 버전
- 헤더 : 요청에 대한 추가 정보(호스트 주소, 브라우저 정보 등)를 담고 있으며 각 줄은 CRLF로 구분됨
- 바디 : 서버로 보낼 실제 데이터가 담겨있음 (헤더와 바디는 빈 줄로 구분됨)

#### HTTP 응답 
- HTTP 응답 : HTTP 요청에 대한 결과를 반환하는 메세지
- 요청이 성공여부, 발생한 에러의 원인과 같은 상태 정보(Status), 클라이언트에게 전달할 리소스가 포함됨
- **시작 줄**
  - 구성 : HTTP 버전 + 상태 코드 + 처리 사유
    - HTTP 버전 : 서버에서 사용하는 HTTP 프로토콜의 버전
    - 상태 코드(Status Code) : 요청에 대한 처리 결과를 나타내는 세 자리 숫자
    - 처리 사유(Reason Phrase) : 상태 코드가 발생한 이유를 짧게 기술한 문장
- 상태 코드의 분류
  | 상태 코드 | 설명 | 대표 예시 |
  |---------|------|-----------|
  | 1xx | 요청을 제대로 받았고, 처리가 진행 중임 |  |
  | 2xx | 요청이 제대로 처리됨 | • 200(OK): 성공 |
  | 3xx | 요청을 처리하려면, 클라이언트가 추가 동작을 취해야 함 | • 302(Found): 다른 URL로 갈 것 |
  | 4xx | 클라이언트가 잘못된 요청을 보내어 처리에 실패함 | • 400(Bad Request): 요청이 문법에 맞지 않음<br>• 401(Unauthorized): 클라이언트가 요청한 리소스에 대한 인증이 실패함<br>• 403(Forbidden): 클라이언트가 리소스에 요청할 권한이 없음<br>• 404(Not Found): 리소스가 없음 |
  | 5xx | 클라이언트의 요청은 유효하지만, 서버에 에러가 발생하여 처리에 실패함 | • 500(Internal Server Error): 서버가 요청을 처리하다가 에러가 발생함<br>• 503(Service Unavailable): 서버가 과부하로 인해 요청을 처리할 수 없음 |
  - HTTP 표준인 RFC 2616은 대략 40여개의 상태 코드를 정의하고 있음
  - 첫 번째 자릿수에 따라 5개의 클래스로 분류됨

  ### HTTPS
  - **HTTPS(HTTP over Secure socket layer)** : HTTP에 **TLS(Transport Layer Security)** 프로토콜을 도입한 버전
  - 등장 배경
    - HTTP는 데이터를 주고받을 때 내용을 암호화하지 않은 평문으로 전달함
    - 공격자가 네트워크 중간에서 데이터를 탈취하거나, 내용을 변조할 수 있음 
  - TLS : 서버와 클라이언트 사이에 오가는 모든 HTTP 메세지를 암호화함
    - 도청과 변조로부터 통신이 안전하게 보호됨
  - 식별 방법 : 웹 서버 URL 확인
    - `http://`로 시작 : HTTP
    - `https://`로 시작 : HTTPS
  
